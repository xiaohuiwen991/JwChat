<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<meta charset="UTF-8">
<head>
    <title>用户登录</title>
    <link rel="icon" href="javascript:void(0)/favicon.ico" type="image/icon"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="format-detection" content="telephone=no"/>
    <link rel="stylesheet" href="../css/common.css"/>

    <link type="text/css" rel="stylesheet" href="../css/wap/web_frame.css??ver1" />
    <link type="text/css" rel="stylesheet" href="../css/wap/change_module.css?ver1" />

<script src="../js/require.2.1.9-jquery.2.0.3-underscore.1.5.2-backbone.1.0.0.js"></script>
<style type="text/css">
    .geetest {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
    }

    .gt_bg {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: gray;
        opacity: 0.7;
    }

    .geetest .gt_wrap {
        width: 300px;
        margin: 10px auto;
        text-align: center;
        background-color: #fff;
        z-index: 2;
        position: relative;
    }

    .gt_wrapper {
        margin: 0 auto;
    }

    .geetest .gt_wrap .gt_top {
        padding: 0 8px;
        height: 44px;
        z-index: 1;
        position: relative;
        text-align: center;
        font-weight: 500;
    }

    .geetest .gt_wrap .title {
        line-height: 45px;
        width: 200px;
        margin: 0 auto;
    }

    .goback {
        position: absolute;
        left: .5rem;
        color: #fff;
        font-size: 1rem;
    }

    input.check::-webkit-input-placeholder {
        /* placeholder颜色  */
        color: red;
    }
</style>
</head>
<body>
    <div class="m_wrap">
        <div class="m_header">
            <a href="javascript:void(0);" class="goback">返回</a>
            账号登录<a class="m_header_refresh J_refresh" href="javascript:void(0);"></a>
        </div>
        <form id="login-form" name="pop-form-login">
            <div>
                <span class="m_label">使用手机号码登录：</span>
            </div>
            <div class="mr_b15 m_input_wrap width90">
                <input class="m_input m_name" type="text" id="email-input" autocomplete="on" placeholder="请输入邮箱或手机号码" name="userName">
                <a href="javascript:void(0);" class="J_input_reset m_reset_btn m_reset_email"></a>
            </div>
            <div class="mr_b25 m_input_wrap width90">
                <input class="m_input m_pwd J_pwd" id="password-input" type="password" placeholder="请输入登录密码" name="password">
                <a href="javascript:void(0);" class="J_input_reset m_reset_btn m_reset_password"></a>
            </div>
            <div class="geetest">
                <div class="gt_bg"></div>
                <div class="gt_wrap">
                    <div class="gt_top">
                        <a class="gt_exit" id="gt_close" href="javascript:void(0);"></a>

                        <div class="title">请拖动按钮通过验证</div>
                    </div>
                    <script type="text/javascript" src="http://api.geetest.com/get.php?gt=f43ff6668a26e10f745d87e1a7b5e731&width=300" async></script>
                </div>
            </div>
            <div class="mr_b15">
                <input class="m_button m_submit" readonly="readonly" value="登录">
            </div>
            <div class="mr_b15">
                <a class="m_button m_button_plain" href="register.htm">注册</a>
            </div>
            <div class="width90">
                <a class="findpw" href="javascript:void(0)/forgetpw">找回密码</a>
            </div>
        </form>
        <div class="external">
            <div class="ex-wrap ex-title">
                <span>其他登录方式</span>
            </div>
        </div>
    </div>
    <div class="toolMenuBg" id="tool_menu_bg" ></div>
    <div class="toolMenu" id="tool_menu" >
        <menu class="toolBut q">
            <li id="toolHome" sorts="9" style=" width:33%;">
                <a id="index_link1" href="../wap_jypx6.html"  >
                    <b class="icon" id="icon_960813">
                        <img src="../images/wap/toolHome_icon.png" />
                    </b>
                    <strong>首页</strong>
                </a>
            </li>
            <li id="toolTel" sorts="8" style=" width:33%;">
                <a  href="contact.html"  >
                    <b class="icon" id="icon_960810">
                        <img src="../images/wap/toolTel_icon.png" />
                    </b>
                    <strong>电话</strong>
                </a>
            </li>
            <li id="toolMember" sorts="1" style=" width:33%;">
                <a  href="mydata.html"  >
                    <b class="icon" id="icon_960814">
                        <img src="../images/wap/toolMember_icon.png" />
                    </b>
                    <strong>会员</strong>
                </a>
            </li>
        </menu>
    </div>
</body>
<style type="text/css">
    ol, ul, dl, menu li {
        list-style: none;
    }
</style>
<script type="text/javascript">

    var device = (function () {
        var a;
        return function () {
            if (a) {
                return a;
            }
            a = {};
            var b = {isIPAD: "ipad", isIPHONE: "iphone", isIPOD: "ipod", isAndroid: "android"}, c;
            var ua = navigator.userAgent.toLowerCase();
            for (c in b) {
                a[c] = -1 !== ua.indexOf(b[c]) ? true : false;
            }
            a.isIOS = a.isIPAD || a.isIPHONE || a.isIPOD;
            return a;
        }
    })();

    //建立ios与native通信桥梁
    var ios_webview_bridge;
    document.addEventListener('WebViewJavascriptBridgeReady', function onBridgeReady(event) {
        ios_webview_bridge = event.bridge;
        ios_webview_bridge.init(function (message, responseCallback) {
            responseCallback(message);
        });
    }, false);
    function iosSendMessage(data, callback) {
        try {
            if (!ios_webview_bridge) {
                setTimeout(function () {
                    iosSendMessage(data, callback);
                }, 40);
                return false;
            }
            ios_webview_bridge.send(data, function responseCallback(responseData) {
                callback && callback(responseData);
            });
        } catch (e) {}
    }

    function clear(){
        document.getElementById('email-input').value = '';
        document.getElementById('password-input').value = '';
    }

    clear();

    var address = window.postAddress;
    var appKey = '';
    var isStageAPP = false;

    if (appKey == '10211') {
        isStageAPP = true;
    }
    var referrer = '';
    $(document).ready(function () {
        if (referrer) {
            $('.goback').attr('href', referrer);
        }
    });

    $('.m_reset_email').click(function(){
        $('#email-input').val('');
    }),$('.m_reset_password').click(function(){
        $('#password-input').val('');
    }),$('.goback').click(function(){
        window.location.href = "../wap_jypx6.html";
    }),$('.m_submit').click(function(){
        var email = $('#email-input').val().trim();
        var password = $('#password-input').val().trim();
        if(email==''||email==null){
            check('email-input');
        }
        if(password==''||password==null){
            check('password-input');
        }
        console.log($('#login-form').serialize())
        $.ajax({
            type: "post",
            dataType: "json",
            url: "http://www.masterjoker.cn:8080/code/wx/business/WeChart/login",
            data:$('#login-form').serialize(),
            success: function (msg) {
                if(msg!=null && msg.flag==1) {
                    window.localStorage.removeItem("userInfo");
                    window.localStorage.removeItem("token");
                    window.localStorage.setItem("userInfo", JSON.stringify(msg.data));
                    window.localStorage.setItem("token", msg.data.id);
                    console.log(msg.data.id);
                    window.location.href = "report.html";
                }
            }
        });
    });

    function check(id){
        var text=document.getElementById(id).value;
        if(text.trim()==''||text.trim()==null){
            document.getElementById(id).value = '';
            $('#'+id).addClass('check');
        }
    }
    var cpro_id = "u2671677";
</script>
</html>